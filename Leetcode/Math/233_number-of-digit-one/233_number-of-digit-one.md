#### [233. æ•°å­— 1 çš„ä¸ªæ•°](https://leetcode-cn.com/problems/number-of-digit-one/)

> #ä¸­ï½éš¾ #é¢è¯•é¢˜
>
> #æ•°å­¦ #å½’çº³æ³• #é€»è¾‘ç®€åŒ– #å…¬å¼  #å…¬å¼è½¬ç¨‹åº

ç»™å®šä¸€ä¸ªæ•´æ•° `n`ï¼Œè®¡ç®—æ‰€æœ‰å°äºç­‰äº `n` çš„éè´Ÿæ•´æ•°ä¸­æ•°å­— `1` å‡ºç°çš„ä¸ªæ•°ã€‚

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥ï¼šn = 13
è¾“å‡ºï¼š6
```

**ç¤ºä¾‹ 2ï¼š**

```
è¾“å…¥ï¼šn = 0
è¾“å‡ºï¼š0 
```

**æç¤ºï¼š**

- `0 <= n <= 109`



# è§£é¢˜æ€è·¯

## 1.æ–¹æ³•ä¸€ï¼šæšä¸¾æ³•ï¼ˆå½’çº³å‡ºæ•°å­¦å…¬å¼ï¼‰

> ä»¥n=1234567ä¸ºä¾‹ï¼Œæƒ³ç»Ÿè®¡ç™¾ä½çš„1ä¸€å…±å‡ºç°å¤šå°‘æ¬¡

1. 1234**0**00çš„ç™¾ä½ä¸€å…±å‡ºç°äº†1234 x 100 æ¬¡1

   - å› ä¸º`[100,199]`å‡ºç°äº†100æ¬¡ç™¾ä½çš„1ï¼Œå¦‚1231**1**00ï½1231**1**99çš„åŒºé—´ä¹Ÿå‡ºç°äº†100æ¬¡1
   - ä»¥æ­¤ç±»æ¨ï¼Œ1**0**00ï½1234**0**00ä¸€å…±å‡ºç°äº†1234 x 100æ¬¡çš„1

2. åˆ†æå‰©ä½™ä½567ä¸­ç™¾ä½å‡ºç°1çš„æ¬¡æ•°ï¼š

   > è®°`n'=567`ï¼Œåˆ™`n'=n%1000-100+1`

   - n' < 100ï¼Œå‡ºç°0æ¬¡
   - 100 â‰¤ n' < 200ï¼Œå‡ºç°n' - 100 + 1 æ¬¡
   - 200 < n'ï¼Œå‡ºç°100æ¬¡

3. ç™¾ä½å‡ºç°1çš„æ¬¡æ•°ç”¨å…¬å¼æ€»ç»“æ˜¯ï¼š
   $$
   âŒŠ1000nâ€‹âŒ‹Ã—100+min(max(nmod1000âˆ’100+1,0),100)
   $$

4. æ¨å¹¿åˆ°å…¶ä»–ä½ï¼ˆä¸ªã€åã€åƒ...ä½ï¼‰ç”¨å…¬å¼è¡¨ç¤ºå°±æ˜¯

$$
âŒŠ10k+1nâ€‹âŒ‹Ã—10k+min(max(nmod10k+1âˆ’10k+1,0),10k)
$$

### 1.2 ç¼–ç¨‹

#### 1.2.1 æ•°æ®ç»“æ„

- `int k = 0`ï¼šåœ¨å¾ªç¯ç¨‹åºæ ‡è®°"ä¸ª"ã€"å"ã€"ç™¾"ã€"åƒ"...çš„ä½œç”¨

  - åœ¨ç¨‹åºä¸­çš„forå¾ªç¯ä¸­èµ·åˆ°äº†ä¸€ä¸ªè®¡æ•°çš„ä½œç”¨

  - ç†è§£ä¸º0ä»£è¡¨ä¸ºä¸ªä½ï¼Œ1ä»£è¡¨åä½ï¼Œ2ä»£è¡¨ç™¾ä½ï¼Œä»¥æ­¤ç±»æ¨

- `int mulk = 1`ï¼šæ˜¯kçš„è¾…åŠ©å˜é‡ï¼ŒåŒæ—¶åœ¨å…¬å¼ä¸­æ›¿ä»£kçš„ä½œç”¨
  - åœ¨å…¬å¼ä¸­èµ·åˆ°äº†æ›¿ä»£kçš„ä½œç”¨ï¼Œæ›´ä¸ºæ–¹ä¾¿ğŸ’¡

- `int sum = 0`ï¼šç»Ÿè®¡ç»“æœ

#### 1.2.2 ç®—æ³•æµç¨‹

1. å¾ªç¯ä½“ï¼šä»ä¸ªä½åˆ°æœ€é«˜ä½éå†

   1. ä¸ªä½ç»Ÿè®¡ä¸€å…±å‡ºç°è¿‡å¤šå°‘æ¬¡1ï¼ˆå³æ‰§è¡Œä¸€æ¬¡å…¬å¼ï¼‰

      > ç™¾ä½ã€åƒä½ä»¥æ­¤ç±»æ¨

   2. ç´¯åŠ æ¬¡æ•°åˆ°sum

2. è¿”å›sum

#### 1.2.3 ä»£ç å®ç°

##### ğŸ’¡å…¬å¼â†’ç¨‹åºçš„ç®€åŒ–

- å½“ n' < 100æ—¶ï¼Œn'-100 + 1çš„å€¼å°äºç­‰äº0ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›ç­‰äº0

  - å› æ­¤æœ‰`max(n_1 - mulk + 1, 0)`

- å½“ n' â‰¥ 200æ—¶ï¼Œn' - 100 + 1çš„å€¼å¤§äº100ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°100çš„ç­”æ¡ˆ

  - å› æ­¤æœ‰`min(res, mulk)`
  - å…¶ä¸­ resæ˜¯ä¸Šä¸€æ­¥0 â‰¤ x â‰¤ mulkçš„ä¸€ä¸ªå€¼

- ç»¼åˆæ¥çœ‹å¯ä»¥å†™æˆï¼š

  â€‹	`min(max(n_1 - mulk + 1, 0), mulk)`

```C++
def countDigitOne(self, n: int) -> int:
    """
    ç»™å®šä¸€ä¸ªæ•´æ•° nï¼Œè®¡ç®—æ‰€æœ‰å°äºç­‰äº n çš„éè´Ÿæ•´æ•°ä¸­æ•°å­— 1 å‡ºç°çš„ä¸ªæ•°ã€‚
    ã€Šæšä¸¾æ³•ã€‹
    :param n: ä¸€ä¸ªæ•´æ•°
    :return: æ‰€æœ‰å°äºç­‰äº n çš„éè´Ÿæ•´æ•°ä¸­æ•°å­— 1 å‡ºç°çš„ä¸ªæ•°
    """
    k, mulk, = 0, 1  # kæ˜¯æ²¡æœ‰ä½œç”¨çš„ï¼Œåªæ˜¯ä»C++ä»£ç è¿ç§»è¿‡æ¥è¡¨ç¤ºä»0å¼€å§‹çš„ä½
    sum = 0
    while n >= mulk:
        k += 1
        n_1 = n % (mulk * 10)
        sum += n // (mulk * 10) * mulk + min(max(n_1 - mulk + 1, 0), mulk)
        mulk *= 10
    return sum
```

### 1.2 å¤æ‚åº¦åˆ†æ

- æ—¶é—´å¤æ‚åº¦ï¼š$O(log n)$ã€‚nåŒ…å«çš„æ•°ä½ä¸ªæ•°ä¸ *n* å‘ˆå¯¹æ•°å…³ç³»

- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$


# æ€»ç»“

- å½’çº³æ•°å­¦å…¬å¼çš„æ€æƒ³
  - å…ˆæ€»ç»“ç™¾ä½ä¸Šå‡ºç°1çš„è§„å¾‹
  - ç„¶åæ¨å¹¿åˆ°ä¸€èˆ¬ä½ï¼ˆåã€åƒã€ä¸‡...ï¼‰ä¸Šå‡ºç°1çš„è§„å¾‹
  - å¯¹ä»»æ„ä¸€ä¸ªæ•°å­—å¯ä»¥ç»¼åˆè¿ç”¨ä¸€ä¸ªé€šç”¨çš„å…¬å¼å¾—åˆ°æ±‚è§£
- ä½¿ç”¨`max()`å’Œ`min()`å®ç°å…¬ç¤ºè½¬ç¨‹åºçš„å¦™ç”¨ğŸ±
- pythonçš„æ•´é™¤è¿ç®—ç¬¦æ˜¯ï¼š `//`
- mulkåœ¨ç¨‹åºä¸­ä¸ä»…èµ·åˆ°ä½æ•°çš„è®¡æ•°å™¨ï¼Œä¹Ÿæ›¿ä»£äº†kèµ·åˆ°äº†åœ¨ç¨‹åºä¸­ä½œä¸ºkçš„å˜é‡çš„ä½œç”¨ï¼ˆæ›´æ–¹ä¾¿ï¼‰

- mulkè®¾ç½®ä¸ºlong longçš„åŸå› ï¼š

  > å› ä¸ºintç±»å‹ä¼šæº¢å‡ºï¼Œint 32ä½(4å­—èŠ‚)ï¼Œæ— ç¬¦å·æ•´å‹æœ€å¤§è¡¨ç¤º2^31 = 2 xxx xxx xxx
  >
  > long long 64ä½(8å­—èŠ‚) 

  ```
  Line 7: Char 33: runtime error: signed integer overflow: 1000000000 * 10 cannot be represented in type 'int' (solution.cpp)
  SUMMARY: UndefinedBehaviorSanitizer: undefined-behavior prog_joined.cpp:16:33
  ```

  æ­¤å¤–ï¼Œ0LLè¡¨ç¤ºlong longç±»å‹ï¼Œåœ¨max()å¯ä»¥ç›¸è¿ç®—